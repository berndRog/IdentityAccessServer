@page "/home"
@using Microsoft.AspNetCore.Authorization
@inject IHttpContextAccessor Hca
@inject NavigationManager Nav
@attribute [AllowAnonymous]

<PageTitle>Banking Client</PageTitle>

<div class="container py-4" style="max-width: 860px;">
  <h1 class="h3 mb-3">Banking</h1>

  @{
    var user = Hca.HttpContext?.User;
    var isAuth = user?.Identity?.IsAuthenticated == true;
    var isOwner = isAuth && user!.IsInRole("Owner");
    var isEmployee = isAuth && user!.IsInRole("Employee");
  }

  @if (!isAuth) {
    <p class="text-muted">Du bist nicht angemeldet.</p>

    <div class="d-flex gap-2">
      <a class="btn btn-primary" href="/identity/login?returnUrl=%2Fdispatcher">Login</a>
    </div>
  }
  else {
    <p class="text-muted">Angemeldet als <b>@user!.Identity!.Name</b></p>

    <div class="d-flex gap-2 flex-wrap">
      @if (isOwner) {
        <a class="btn btn-primary" href="/owner">Owner Bereich</a>
        <a class="btn btn-outline-secondary" href="/owner/profile">Profil</a>
      }
      @if (isEmployee) {
        <a class="btn btn-primary" href="/employee">Employee Bereich</a>
      }

      <a class="btn btn-outline-danger ms-auto" href="/identity/logout">Logout</a>
    </div>

    @if (!isOwner && !isEmployee) {
      <div class="alert alert-warning mt-3">
        Keine passende Rolle gefunden.
      </div>
    }
  }
</div>